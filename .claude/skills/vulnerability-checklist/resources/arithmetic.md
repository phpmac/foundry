# 算术漏洞类

## 1. 精度损失

**风险等级**: 中危

**漏洞逻辑**: 先除后乘导致精度丢失,累积后造成资金损失。

```solidity
contract VulnerablePrecision {
    function calculateReward(uint256 amount, uint256 rate) public pure returns (uint256) {
        return amount / 1000 * rate; // 错误: 先除后乘
    }

    function calculateRewardFixed(uint256 amount, uint256 rate) public pure returns (uint256) {
        return amount * rate / 1000; // 正确: 先乘后除
    }
}
```

**检测方法**: 检查除法运算顺序,使用边界值测试

---

## 2. unchecked溢出

**风险等级**: 中危

**漏洞逻辑**: unchecked块内运算可能溢出/下溢。

```solidity
contract VulnerableUnchecked {
    function unsafeDecrement(uint256 x) public pure returns (uint256) {
        unchecked {
            return x - 1; // x=0时下溢为type(uint256).max
        }
    }
}
```

**检测方法**: 搜索 `unchecked` 块,验证边界条件
